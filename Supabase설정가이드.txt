==========================================
Supabase 설정 가이드 (회원가입/로그인 작동하게 만들기)
==========================================

회원가입/로그인이 작동하지 않는 주요 원인은 Supabase의 이메일 확인 설정입니다.
다음 설정을 따라하시면 바로 작동합니다!

==========================================
1단계: Supabase 프로젝트 접속
==========================================

1. https://supabase.com/ 접속
2. 로그인
3. 프로젝트 선택

==========================================
2단계: 이메일 확인 비활성화 (중요!)
==========================================

1. 좌측 메뉴에서 "Authentication" 클릭
2. "Settings" 탭 클릭
3. "Auth" 섹션에서 다음 설정 찾기:
   - "Enable email confirmations" 체크박스
4. 체크박스를 해제 (비활성화)
5. 페이지 하단 "Save" 버튼 클릭

⚠️ 중요: 이 설정을 하지 않으면 회원가입 후 이메일 확인을 해야 로그인할 수 있습니다.

==========================================
3단계: API 키 확인
==========================================

1. 좌측 메뉴 "Settings" → "API" 클릭
2. 다음 정보 확인:

   Project URL:
   - 예: https://xxxxxxxxxxxxx.supabase.co
   - 이 값을 SUPABASE_URL 환경 변수에 설정

   service_role key (Secret):
   - 긴 문자열 (eyJ...로 시작)
   - ⚠️ 이 키는 절대 공개하지 마세요!
   - 이 값을 SUPABASE_SERVICE_KEY 환경 변수에 설정

   anon public key:
   - 필요시 사용 (현재는 service_role 사용)

==========================================
4단계: Vercel 환경 변수 확인
==========================================

1. Vercel 대시보드 접속
2. 프로젝트 선택
3. "Settings" → "Environment Variables" 클릭
4. 다음 변수들이 올바르게 설정되어 있는지 확인:

   SUPABASE_URL
   - 값: https://xxxxxxxxxxxxx.supabase.co (슬래시 없이)

   SUPABASE_SERVICE_KEY
   - 값: eyJ...로 시작하는 긴 문자열
   - ⚠️ 공백이나 줄바꿈이 없어야 합니다

5. 변수가 없거나 잘못되었다면:
   - "Add New" 클릭
   - Name과 Value 입력
   - Environment: Production, Preview, Development 모두 체크
   - "Save" 클릭

6. 환경 변수 수정 후:
   - "Deployments" 탭으로 이동
   - 최신 배포 옆 "..." 메뉴 클릭
   - "Redeploy" 클릭
   - "Use existing Build Cache" 체크 해제
   - "Redeploy" 클릭

==========================================
5단계: 테스트
==========================================

1. 배포된 사이트 접속
2. 회원가입 시도
3. 로그인 시도

✅ 정상 작동하면 성공!

==========================================
문제 해결
==========================================

Q: 여전히 "이메일 확인이 필요합니다" 오류가 발생합니다
A:
   1. Supabase에서 "Enable email confirmations"가 해제되었는지 확인
   2. Vercel에서 환경 변수가 올바른지 확인
   3. Vercel에서 "Redeploy" 실행

Q: "서버 설정 오류입니다" 메시지가 나옵니다
A:
   1. Vercel 환경 변수에서 SUPABASE_URL과 SUPABASE_SERVICE_KEY 확인
   2. 값에 공백이나 특수문자가 없는지 확인
   3. Supabase에서 키를 다시 복사하여 설정

Q: 회원가입은 되는데 로그인이 안됩니다
A:
   1. Supabase "Authentication" → "Users"에서 사용자가 생성되었는지 확인
   2. 비밀번호가 올바른지 확인
   3. Vercel 로그 확인 (Deployments → 최신 배포 → "View Function Logs")

Q: "Invalid API key" 오류
A:
   1. SUPABASE_SERVICE_KEY가 service_role key인지 확인 (anon key가 아님)
   2. 키가 전체 복사되었는지 확인 (앞뒤 공백 없음)
   3. Supabase에서 키를 다시 복사

==========================================
추가 설정 (선택사항)
==========================================

비밀번호 정책 설정:
1. Supabase "Authentication" → "Settings"
2. "Password" 섹션에서 최소 길이 등 설정 가능

이메일 템플릿 커스터마이징:
1. "Email Templates" 탭에서 이메일 내용 수정 가능
2. (이메일 확인을 비활성화했다면 필요 없음)

==========================================
완료!
==========================================

이제 회원가입과 로그인이 정상 작동합니다!

==========================================

